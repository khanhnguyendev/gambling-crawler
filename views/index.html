<!DOCTYPE html>
<html>

<head>
  <title>Gambling Crawler</title>
  <script src="/socket.io/socket.io.js"></script>
  <link rel="stylesheet" href="../assets/main.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <!-- <script defer src="../script/main.js"></script> -->
  <script>
    const socket = io();

    socket.on('log', (msg) => {
      const logDiv = document.createElement('div');
      logDiv.classList.add('log-line');
      logDiv.innerText = msg || "Test message";

      const logLines = document.querySelectorAll('#myTable .log-line');
      const currentIndex = logLines.length;
      const currentRowIndex = Math.floor(currentIndex / 10);
      const currentCellIndex = currentIndex % 10;

      let currentRow = document.querySelector(`#myTable tbody tr:nth-child(${currentRowIndex + 1})`);
      if (!currentRow) {
        currentRow = document.createElement('tr');
        document.querySelector('#myTable tbody').appendChild(currentRow);
      }

      let currentCell = document.querySelector(`#myTable tbody tr:nth-child(${currentRowIndex + 1}) td:nth-child(${currentCellIndex + 1})`);
      if (!currentCell) {
        for (let i = 0; i < 10; i++) {
          currentCell = document.createElement('td');
          currentCell.classList.add('text-center');
        }
        currentRow.appendChild(currentCell);
      }

      currentCell.appendChild(logDiv);
    });
  </script>
</head>

<body>
  <div id="log"></div>
  <div class="container">
    <table id="myTable" class="table table-bordered">
      <thead>
        <tr>
          <th>1</th>
          <th>2</th>
          <th>3</th>
          <th>4</th>
          <th>5</th>
          <th>6</th>
          <th>7</th>
          <th>8</th>
          <th>9</th>
          <th>10</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="text-center"></td>
          <td class="text-center"></td>
          <td class="text-center"></td>
          <td class="text-center"></td>
          <td class="text-center"></td>
          <td class="text-center"></td>
          <td class="text-center"></td>
          <td class="text-center"></td>
          <td class="text-center"></td>
          <td class="text-center"></td>
        </tr>
      </tbody>
    </table>
  </div>

</body>

</html>